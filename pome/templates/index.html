{% extends 'base.html' %}
{% block main_title %}
Accounts
{% endblock %}
{% block content %}

{% if not accounts_chart %}

<div class="{{classes_warning_box}}" role="alert">
  <p>File {{CWD}}/accounts_chart.json was not found. Find examples in the doc (TODO).
  </p>
</div>

{% else %}

{% if not accounts_chart.accounts %}

{% if accounts_chart.accounts_csv_file_error %}
<div class="{{classes_warning_box}}" role="alert">
  <p>File {{CWD}}/{{accounts_chart.accounts_csv_file}}, referred by {{CWD}}/accounts_chart.json, was not found.
  </p>
</div>
{%endif%}

No accounts found. Refer to pome's doc for example accounts charts.

{%else%}

<header class="w-full flex justify-end">
  <a href="/transactions/new">
    <div class="btn btn-success text-lg font-bold">New Transaction</div>
  </a>
</header>

{% for section_prefix in accounts_chart.section_prefixes_map %}
{% set accounts_of_section = accounts_chart.section_account_code_map[section_prefix] %}
{% if accounts_of_section %}
<h1 class="text-2xl">{{section_prefix}} - {{accounts_chart.section_prefixes_map[section_prefix].name}}</h1>
<div class="p-5 text-xl">
  <table class="w-full">
    <thead class="text-left">
      <th>Code</th>
      <th>Name</th>
      <th>Balance</th>
    </thead>
    <tbody>
      {% for account_code in accounts_of_section %}
      {% set acc = accounts_chart.account_codes[account_code]%}
      <tr>
        <td>{{acc.code}}</td>
        <td style="width: 490px;"><a href="/accounts/{{acc.code}}" class="normal-link">{{acc.name}}</a></td>
        <td><span class="cursor-default"
            title="{{acc.balance(formatted=True, algebrised=False)}}">{{acc.balance(formatted=True,
            algebrised=True)}}</span>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{%endif%}
{% endfor %}



{% endif %}
{% endif %}

{% endblock %}